<!DOCTYPE html>
<html>
<head>
    <title>參數輸入網頁</title>
    <style>
        body{
            background: #f4f1ea;
            width: auto;
        }
        h1{
            font-family: MicrosoftJhengHeiRegular;
            margin-bottom: 25px;
        }
        .parameter-grid {
            width: 800px;
            background-color: #e4d8d86c;
            align-items: center;
            display: flex;
            flex-direction: column;
            /*justify-content: center;*/

            padding-bottom: 40px;
            padding-top: 80px;
        }

        label {
            font-size: 22px;
            padding-right: 10px;
            padding-bottom: 5px;
        }
        input,select{
            margin-bottom: 15px;
            font-size: 20px;
            height: 25px;
        }
        .parameter{
            margin: auto;
            margin-bottom: 30px;
            display: flex;
            flex-direction: column;
        }
        .button-save {
            cursor: pointer;
            background-color: #808080;
            color: #fff;
            padding: 10px 20px;
            border-radius: 5px;
            text-align: center;
            font-size: 20px;
            margin-bottom: 35px;
        }
        .button-save:hover{
            background-color: rgb(0, 0, 0, 0.75);
        }
    </style>
</head>
<body>
    <center><div style="text-align: center;"><h1>參數調整</h1></div></center>
    <center><div class="parameter-grid">
       <div class="parameter">
            <label for="epochs">Epochs:</label>
            <input type="number" id="epochs" name="epochs" required>
       
            <label for="batch-size">Batch Size:</label>
            <input type="number" id="batch-size" name="batch_size" required>
       
            <label for="learning-rate">Learning Rate:</label>
            <input type="number" step="0.001" id="learning-rate" name="learning_rate" required>
      
        <!-- <div>
            <label for="pretrained">Pretrained:</label>
            <input type="number" id="pretrained" name="pretrained" required>
        </div> -->
        
            <label for="pretrained">Pretrained:</label>
            <select id="pretrained" name="pretrained" required>
                <option value="yes">Yes</option>
                <option value="no">No</option>
            </select>
        </div>
        <!-- </div>
        <div>
            <label for="patience">Patience:</label>
            <input type="number" id="patience" name="patience" required>
        </div> -->
        <div class="button-save" id="save-button">儲存</div>
        <div class="button-save" id="save-button" onclick="redirectToTrain()">訓練</div>
        <div class="button-save" onclick="redirectToPredict()">預測</div>
    </div></center>

    <script>
        document.getElementById('save-button').addEventListener('click', function () {
            // 獲取所有輸入框的數據
            var learningRate = document.getElementById('learning-rate').value;
            var batchSize = document.getElementById('batch-size').value;
            var epochs = document.getElementById('epochs').value;
            var pretrained = document.getElementById('pretrained').value;
            // var patience = document.getElementById('patience').value;

            // 將數據拼接為一個字符串
            var data = "Learning Rate: " + learningRate + "\n" +
                "Batch Size: " + batchSize + "\n" +
                "Epochs: " + epochs + "\n" +
                "Pretrained: " + pretrained + "\n" ;
                // "Patience: " + patience;

            //to backend
            var params = {
                learningRate: learningRate,
                batchSize: batchSize,
                epochs: epochs,
                pretrained: pretrained
                // patience: patience
            };
            fetch('/python-endpoint', {
                method: 'POST',
                headers: {
                  'Content-Type': 'application/json'
                },
                body: JSON.stringify(params)
            })
            .then(response => {
                if (response.ok) {
                  return response.json();
                } else {
                  throw new Error('請求失敗');
                }
            })
            .then(data => {
                console.log(data);
            })
            .catch(error => {
                console.error(error);
            });

            // 創建一個Blob對象，用於保存txt數據
            var blob = new Blob([data], { type: 'text/plain' });

            // 創建一個a標籤，用於下載txt檔
            var a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = 'parameter_data.txt';
            a.click();
        });
        function redirectToTrain() {
            window.location.href = "train";
        }
        function redirectToPredict() {
            window.location.href = "predict";
        }
    </script>
</body>
</html>
